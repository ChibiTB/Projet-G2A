<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DBreeze - Accueil</title>
  <link rel="stylesheet" href="Vue/index.css" />
  <link rel="stylesheet" href="Vue/header.css" />
  <link rel="stylesheet" href="Vue/footer.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">
</head>
<body>
  <div id="header-placeholder"></div>

  <main>
    <section class="hero">
      <div class="hero-content">
        <h1>Supervision en temps r√©el</h1>
        <p>Contr√¥lez votre environnement en un coup d'≈ìil</p>
      </div>
    </section>

    <!-- ‚úÖ Message de bienvenue -->
    <div class="welcome-message" id="welcome-message"></div>

    <!-- ‚úÖ Compteur de d√©cibels dynamique -->
    <section class="decibel-led">
      <h3>Niveau sonore actuel</h3>
      <div class="led-display" id="niveau-sonore">...</div>
    </section>

    <!-- ‚úÖ Tableau de bord -->
    <section id="supervision" class="sensors-section">
      <div class="section-title">
        <h2>TABLEAU DE BORD</h2>
        <p class="subtitle">Tous vos capteurs en temps r√©el</p>
      </div>

      <div class="sensors-grid">
        <div class="sensor-card sound" onclick="window.location.href='sonore.html'">
          <div class="card-content">
            <i class="fas fa-volume-up"></i>
            <h3>Niveau Sonore</h3>
            <p>Ambiance parfaitement ma√Ætris√©e</p>
          </div>
        </div>

        <div class="sensor-card lighting" onclick="window.location.href='luminosite.html'">
          <div class="card-content">
            <i class="fas fa-lightbulb"></i>
            <h3>Luminosit√©</h3>
            <p>Une atmosph√®re unique</p>
          </div>
        </div>

        <button class="sensor-card co2" onclick="window.location.href='temphum.html'">
          <div class="card-content">
            <i class="fas fa-wind"></i>
            <h3>Humidit√© de l'air</h3>
            <p>Respirez la diff√©rence</p>
          </div>
        </button>

        <button class="sensor-card temperature" onclick="window.location.href='temphum.html'">
          <div class="card-content">
            <i class="fas fa-temperature-high"></i>
            <h3>Temp√©rature & Humidit√©</h3>
            <p>Confort optimal</p>
          </div>
        </button>

        <button class="sensor-card crowd" onclick="window.location.href='#'">
          <div class="card-content">
            <i class="fas fa-users"></i>
            <h3>Affluence</h3>
            <p>Gestion intelligente des espaces</p>
          </div>
        </button>

        <div class="sensor-card security" onclick="window.location.href='distance.html'">
          <div class="card-content">
            <i class="fas fa-shield-alt"></i>
            <h3>S√©curit√©</h3>
            <p>Protection continue</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <div id="footer-placeholder"></div>

  <!-- ‚úÖ Scripts -->
  <script>
    async function includeHTML(selector, url) {
      const element = document.querySelector(selector);
      const response = await fetch(url);
      const html = await response.text();
      element.innerHTML = html;
    }

    includeHTML("#header-placeholder", "header.html");
    includeHTML("#footer-placeholder", "footer.html");

    const params = new URLSearchParams(window.location.search);
    const prenom = params.get("prenom");
    if (prenom) {
      const welcome = document.getElementById("welcome-message");
      welcome.innerHTML = `<h2 style="text-align:center; color: var(--color-primary); margin: 3rem 0;">Bienvenue ${prenom} üëã</h2>`;
    }

    // ‚úÖ Mise √† jour dynamique du niveau sonore
    async function updateNiveauSonore() {
      try {
        const response = await fetch('get_last_sonore.php');
        const data = await response.json();
        const valeur = data.sonore !== null ? `${data.sonore} dB` : 'N/A';
        document.getElementById('niveau-sonore').textContent = valeur;
      } catch (error) {
        console.error('Erreur de r√©cup√©ration sonore :', error);
        document.getElementById('niveau-sonore').textContent = 'Erreur';
      }
    }

    updateNiveauSonore();
    setInterval(updateNiveauSonore, 5000);
  </script>
</body>
</html>
